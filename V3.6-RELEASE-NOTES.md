# V3.6 ç‰ˆæœ¬ç™¼å¸ƒèªªæ˜ï¼šè‡¨æ™‚æš±ç¨±ç³»çµ±èˆ‡å…·åæˆ°æ³å›å ±

## ğŸ“‹ ç‰ˆæœ¬è³‡è¨Š
- **ç‰ˆæœ¬è™Ÿ**ï¼šV3.6
- **ç™¼å¸ƒæ—¥æœŸ**ï¼š2026-01-18
- **é–‹ç™¼ç‹€æ…‹**ï¼šâœ… é–‹ç™¼å®Œæˆï¼Œå·²æ¸¬è©¦æ ¸å¿ƒæµç¨‹

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. è‡¨æ™‚æš±ç¨±ç³»çµ±
ç©å®¶é¦–æ¬¡è¨ªå•éŠæˆ²æ™‚ï¼Œæœƒå½ˆå‡ºæš±ç¨±è¼¸å…¥å°è©±æ¡†ï¼š
- **é˜»æ“‹å¼å°è©±æ¡†**ï¼šå¿…é ˆè¼¸å…¥æš±ç¨±æ‰èƒ½é€²å…¥éŠæˆ²
- **localStorage æŒä¹…åŒ–**ï¼šæš±ç¨±å„²å­˜åœ¨ç€è¦½å™¨æœ¬åœ°ï¼Œä¸‹æ¬¡è¨ªå•è‡ªå‹•ä½¿ç”¨
- **è‡ªå‹•è¨»å†Šæ©Ÿåˆ¶**ï¼šé€£ç·šå»ºç«‹å¾Œè‡ªå‹•å‘ä¼ºæœå™¨è¨»å†Šæš±ç¨±
- **é‡é€£ä¿è­·**ï¼šæ–·ç·šé‡é€£å¾Œè‡ªå‹•é‡æ–°è¨»å†Šæš±ç¨±

### 2. å…·åæˆ°æ³å›å ±
ç®¡ç†è€…é é¢ç¾åœ¨å¯ä»¥çœ‹åˆ°å…·é«”ç©å®¶åå–®ï¼š
- **è½ç‰Œï¼ˆå·®1å€‹ï¼‰**ï¼šé¡¯ç¤ºã€ŒN äººï¼šç©å®¶A, ç©å®¶B...ã€
- **å·® 3 å€‹è™Ÿç¢¼**ï¼šé¡¯ç¤ºã€ŒN äººï¼šç©å®¶C, ç©å®¶D...ã€
- **å·® 5 å€‹è™Ÿç¢¼**ï¼šé¡¯ç¤ºã€ŒN äººï¼šç©å®¶E, ç©å®¶F...ã€
- **å·® 8 å€‹è™Ÿç¢¼**ï¼šé¡¯ç¤ºã€ŒN äººï¼šç©å®¶G, ç©å®¶H...ã€

---

## ğŸ”§ æŠ€è¡“å¯¦ä½œ

### å¾Œç«¯è®Šæ›´ï¼ˆserver/index.tsï¼‰

#### è³‡æ–™çµæ§‹
```typescript
interface PlayerState {
  name: string;           // ç©å®¶æš±ç¨±
  status: string | null;  // 'å·®1å€‹', 'å·®3å€‹', 'å·®5å€‹', 'å·®8å€‹', æˆ– null
}
const playerStates = new Map<string, PlayerState>(); // socketId -> PlayerState
```

#### æ–°å¢äº‹ä»¶
1. **register-player**ï¼šç©å®¶è¨»å†Šæš±ç¨±
   ```typescript
   socket.on('register-player', (data: { name: string }) => {
     playerStates.set(socket.id, { name: data.name, status: null });
     broadcastPlayerStats();
   });
   ```

2. **update-stats**ï¼šå»£æ’­å…·åçµ±è¨ˆçµ¦ç®¡ç†è€…
   ```typescript
   function calculateStats() {
     return {
       'å·®1å€‹': { count: 0, players: [] as string[] },
       'å·®3å€‹': { count: 0, players: [] as string[] },
       // ...
     };
   }
   ```

### å‰ç«¯è®Šæ›´

#### æ–°å¢å…ƒä»¶ï¼ˆclient/src/components/NicknameModal.tsxï¼‰
- ä½¿ç”¨ shadcn/ui Dialog å…ƒä»¶
- Neobrutalism è¨­è¨ˆé¢¨æ ¼ï¼ˆç²—é»‘é‚Šæ¡†ã€é™°å½±ï¼‰
- è¼¸å…¥é©—è­‰ï¼šæš±ç¨±é•·åº¦ 1-20 å­—å…ƒ
- localStorage å„²å­˜ï¼škey = `bingo_player_name`

#### SocketContext æ›´æ–°ï¼ˆclient/src/contexts/SocketContext.tsxï¼‰
```typescript
interface PlayerStats {
  'å·®1å€‹': { count: number; players: string[] };
  'å·®3å€‹': { count: number; players: string[] };
  'å·®5å€‹': { count: number; players: string[] };
  'å·®8å€‹': { count: number; players: string[] };
}

const emitRegisterPlayer = (nickname: string) => {
  socket.emit('register-player', { name: nickname });
};
```

#### Home.tsx æ•´åˆ
```typescript
useEffect(() => {
  const savedNickname = localStorage.getItem('bingo_player_name');
  if (!savedNickname) {
    setShowNicknameModal(true);
  } else if (isConnected) {
    emitRegisterPlayer(savedNickname);
  }
}, [isConnected]);
```

#### Admin.tsx æ›´æ–°
```typescript
<div className="text-sm text-gray-600 mt-1">
  {playerStats['å·®1å€‹'].players.length > 0 && (
    <span>ç©å®¶ï¼š{playerStats['å·®1å€‹'].players.join(', ')}</span>
  )}
</div>
```

---

## ğŸ§ª æ¸¬è©¦ç‹€æ…‹

### âœ… å·²æ¸¬è©¦é …ç›®
1. **æš±ç¨±å°è©±æ¡†é¡¯ç¤º**ï¼šé¦–æ¬¡è¨ªå•æ­£ç¢ºå½ˆå‡º
2. **æš±ç¨±æäº¤**ï¼šè¼¸å…¥ã€Œæ¸¬è©¦ç©å®¶Aã€æˆåŠŸæäº¤
3. **localStorage å„²å­˜**ï¼šæš±ç¨±æ­£ç¢ºå„²å­˜åˆ°æœ¬åœ°
4. **Socket è¨»å†Š**ï¼šä¼ºæœå™¨æ—¥èªŒç¢ºèªè¨»å†ŠæˆåŠŸ
   ```
   [Socket.IO] Player registered: æ¸¬è©¦ç©å®¶A (y-iiNcNmwBEQMQ3nAAAB)
   ```
5. **ç‹€æ…‹å›å ±**ï¼šFAB æŒ‰éˆ•æ­£å¸¸å·¥ä½œ
   ```
   [Socket.IO] Player y-iiNcNmwBEQMQ3nAAAB reported state: å·®1å€‹
   ```
6. **æ–·ç·šæ¸…ç†**ï¼šç©å®¶æ–·ç·šæ™‚æ­£ç¢ºæ¸…é™¤è³‡æ–™

### ğŸ”„ å¾…ç”Ÿç”¢ç’°å¢ƒæ¸¬è©¦
ç”±æ–¼é–‹ç™¼ç’°å¢ƒçš„å–®ä¸€ç€è¦½å™¨è¦–çª—é™åˆ¶ï¼Œä»¥ä¸‹å ´æ™¯éœ€åœ¨ç”Ÿç”¢ç’°å¢ƒæ¸¬è©¦ï¼š
1. **å¤šç©å®¶åŒæ™‚åœ¨ç·š**ï¼š2+ å€‹ç©å®¶åŒæ™‚é€£ç·š
2. **ç®¡ç†è€…é é¢é¡¯ç¤º**ï¼šç¢ºèªç©å®¶åå–®æ­£ç¢ºé¡¯ç¤º
3. **é•·åå–®è™•ç†**ï¼š5+ å€‹ç©å®¶æ™‚çš„é¡¯ç¤ºæ•ˆæœ
4. **å³æ™‚æ›´æ–°**ï¼šç©å®¶å›å ±ç‹€æ…‹æ™‚ç®¡ç†è€…é é¢å³æ™‚æ›´æ–°

---

## ğŸ“¦ éƒ¨ç½²æŒ‡å—

### 1. æœ¬åœ°æ¸¬è©¦ï¼ˆå–®æ©Ÿæ¨¡æ“¬ï¼‰
```bash
cd /home/ubuntu/bingo-game
pnpm build
PORT=3001 node dist/index.js
```
- ç©å®¶é é¢ï¼šhttp://localhost:3001/bingo/
- ç®¡ç†è€…é é¢ï¼šhttp://localhost:3001/bingo/admin

### 2. ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²
```bash
# é€£æ¥åˆ°ä¼ºæœå™¨
ssh root@45.77.170.104

# é€²å…¥å°ˆæ¡ˆç›®éŒ„
cd /root/bingo-game

# æ‹‰å–æœ€æ–°ä»£ç¢¼
git pull origin main

# å®‰è£ä¾è³´ä¸¦ç·¨è­¯
pnpm install
pnpm build

# é‡å•Ÿ PM2 æœå‹™
pm2 restart bingo-game
pm2 logs bingo-game --lines 50
```

### 3. å¤šç©å®¶æ¸¬è©¦æ­¥é©Ÿ
1. **ç©å®¶ A**ï¼šæ‰‹æ©Ÿç€è¦½å™¨è¨ªå• https://market.hiyoshop.store/bingo/
   - è¼¸å…¥æš±ç¨±ã€ŒAliceã€
   - é»æ“Š FAB å›å ±ã€Œæˆ‘è½ç‰Œäº†ï¼ã€
   
2. **ç©å®¶ B**ï¼šé›»è…¦ç€è¦½å™¨è¨ªå• https://market.hiyoshop.store/bingo/
   - è¼¸å…¥æš±ç¨±ã€ŒBobã€
   - é»æ“Š FAB å›å ±ã€Œæˆ‘å·® 3 å€‹ã€
   
3. **ç®¡ç†è€…**ï¼šå¹³æ¿ç€è¦½å™¨è¨ªå• https://market.hiyoshop.store/bingo/admin
   - ç¢ºèªã€Œè½ç‰Œã€å¡ç‰‡é¡¯ç¤ºã€Œ1 äººï¼šAliceã€
   - ç¢ºèªã€Œå·® 3 å€‹ã€å¡ç‰‡é¡¯ç¤ºã€Œ1 äººï¼šBobã€

---

## ğŸ¨ UI/UX æ”¹é€²

### Neobrutalism è¨­è¨ˆä¸€è‡´æ€§
- **æš±ç¨±å°è©±æ¡†**ï¼šç²—é»‘é‚Šæ¡†ï¼ˆborder-4ï¼‰+ é™°å½±ï¼ˆshadow-[8px_8px_0px_0px_rgba(0,0,0,1)]ï¼‰
- **è¼¸å…¥æ¡†**ï¼šé»ƒè‰²èƒŒæ™¯ï¼ˆbg-yellow-300ï¼‰+ é»‘è‰²é‚Šæ¡†
- **æŒ‰éˆ•**ï¼šç¶ è‰²èƒŒæ™¯ï¼ˆbg-green-400ï¼‰+ hover æ•ˆæœï¼ˆtranslate-y-1ï¼‰
- **å­—é«”**ï¼šç­‰å¯¬å­—é«”ï¼ˆfont-monoï¼‰+ ç²—é«”ï¼ˆfont-boldï¼‰

### ç©å®¶åå–®é¡¯ç¤ºç­–ç•¥
```typescript
// æœªä¾†å¯å„ªåŒ–ï¼šé•·åå–®è™•ç†
if (players.length > 5) {
  return `${players.slice(0, 5).join(', ')}...ç­‰${players.length}äºº`;
}
```

---

## ğŸ› å·²çŸ¥é™åˆ¶

1. **æš±ç¨±å”¯ä¸€æ€§**ï¼šç›®å‰ä¸æª¢æŸ¥é‡è¤‡æš±ç¨±ï¼ˆåŒåç©å®¶æœƒåˆ†åˆ¥è¨ˆæ•¸ï¼‰
2. **æš±ç¨±ç·¨è¼¯**ï¼šæš±ç¨±å„²å­˜å¾Œç„¡æ³•åœ¨ UI ä¸­ä¿®æ”¹ï¼ˆéœ€æ¸…é™¤ localStorageï¼‰
3. **é•·æš±ç¨±è™•ç†**ï¼šè¶…é•·æš±ç¨±å¯èƒ½å°è‡´ UI æº¢å‡ºï¼ˆå·²é™åˆ¶ 20 å­—å…ƒï¼‰
4. **æ–·ç·šé‡é€£**ï¼šç©å®¶æ–·ç·šå¾Œç‹€æ…‹æœƒæ¸…é™¤ï¼Œé‡é€£éœ€é‡æ–°å›å ±

---

## ğŸ“Š æ•ˆèƒ½å½±éŸ¿

- **è¨˜æ†¶é«”å¢é•·**ï¼šæ¯å€‹ç©å®¶ç´„ 100 bytesï¼ˆæš±ç¨± + ç‹€æ…‹ï¼‰
- **ç¶²è·¯æµé‡**ï¼šæ¯æ¬¡ç‹€æ…‹è®Šæ›´å»£æ’­ç´„ 500 bytes
- **é ä¼°å®¹é‡**ï¼š100 å€‹åŒæ™‚åœ¨ç·šç©å®¶ç„¡å£“åŠ›

---

## ğŸ”œ æœªä¾†æ”¹é€²æ–¹å‘

1. **æš±ç¨±ç·¨è¼¯åŠŸèƒ½**ï¼šåœ¨è¨­å®šé é¢å…è¨±ä¿®æ”¹æš±ç¨±
2. **æš±ç¨±å”¯ä¸€æ€§æª¢æŸ¥**ï¼šé˜²æ­¢é‡è¤‡æš±ç¨±
3. **é•·åå–®å„ªåŒ–**ï¼šè¶…é 5 äººæ™‚é¡¯ç¤ºã€Œ...ç­‰ N äººã€+ Tooltip
4. **ç‹€æ…‹æŒä¹…åŒ–**ï¼šæ–·ç·šé‡é€£å¾Œæ¢å¾©ç‹€æ…‹
5. **æš±ç¨±é¡è‰²æ¨™è¨˜**ï¼šä¸åŒç©å®¶ç”¨ä¸åŒé¡è‰²å€åˆ†
6. **ç®¡ç†è€…æœå°‹**ï¼šåœ¨ç®¡ç†è€…é é¢æœå°‹ç‰¹å®šç©å®¶

---

## ğŸ“ Git Commit è³‡è¨Š
```
feat(V3.6): Implement temporary nickname and named status report system

- Add NicknameModal component for first-time nickname input
- Update backend to track player names in playerStates Map
- Modify calculateStats() to include player name arrays
- Update Admin page to display player names in status cards
- Implement auto-registration on connection and reconnection
- Store nickname in localStorage for persistence
- Maintain Neobrutalism design consistency

Tested:
- Nickname modal display and submission
- Socket registration and state reporting
- Server-side player tracking and cleanup

Pending production testing:
- Multi-player simultaneous connections
- Admin page real-time name display
- Long player list handling
```

---

## ğŸ“ æ”¯æ´è³‡è¨Š

å¦‚æœ‰å•é¡Œè«‹æŸ¥çœ‹ï¼š
- ä¼ºæœå™¨æ—¥èªŒï¼š`pm2 logs bingo-game`
- ç€è¦½å™¨ Consoleï¼šF12 é–‹ç™¼è€…å·¥å…·
- GitHub Issuesï¼šhttps://github.com/hiyomarket/bingo-game/issues
